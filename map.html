<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Carte - EM AREA</title>
    
    <link rel="stylesheet" href="style.css">
    <!-- LEAFLET -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
</head>
<body>
    <header class="app-header">
        <a href="index.html" class="logo">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#FF9F1C" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
            EM <span>GPS</span>
        </a>
        <!-- Bouton avec un ID 'loc-btn' pour le JS -->
<div id="loc-btn" class="header-pill-btn" onclick="locateUser()" style="background:#fff3e0; color:#FF9F1C;">
    üìç <span>Ma position</span>
</div>
    </header>

    <div class="container">
        <!-- CARTE (Affichage forc√©) -->
        <div id="map"></div>

        <div class="section-title">Boutiques √† proximit√©</div>
        
        <div id="distance-list" class="distance-list">
            <div style="padding:20px; text-align:center; color:#999;">Chargement de la localisation...</div>
        </div>
    </div>
    <!-- FOOTER GLOBAL -->
<footer>
    <div class="container">
        <!-- Section du haut : Invitation √† installer -->
        <div class="install-box">
            <h3 style="color:white; margin:0 0 5px;">üì≤ Installez l'App</h3>
            <p>Acc√©dez au march√© plus rapidement sans passer par le navigateur.</p>
           <button class="btn btn-primary" onclick="installPWA()">
    Installer Maintenant
</button>
        </div>

        <div class="footer-content">
            <!-- Colonne 1 : √Ä propos -->
            <div class="footer-col">
                <div class="logo" style="margin-bottom:15px; color:white;">EM <span>AREA</span></div>
                <p style="font-size:0.8rem; line-height:1.6;">
                    Le premier march√© digital connect√© √† Lom√©. Trouvez des produits, des jobs et localisez les boutiques en un clic.
                </p>
                
                <!-- R√âSEAUX SOCIAUX AVEC LINKEDIN -->
                <div class="social-links">
                    <a href="#" class="social-icon"><svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg></a>
                    <a href="#" class="social-icon"><svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a>
                    <a href="#" class="social-icon">
                        <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
                    </a>
                </div>
            </div>

            <!-- Colonne 2 : Liens Rapides -->
            <div class="footer-col">
                <h3>Explorer</h3>
                <ul class="footer-links">
                    <li><a href="index.html">Accueil & Promos</a></li>
                    <li><a href="map.html">Carte GPS</a></li>
                    <li><a href="jobs.html">Offres d'emploi</a></li>
                    <li><a href="vendre.html">Devenir Vendeur</a></li>
                </ul>
            </div>

            <!-- Colonne 3 : Support -->
            <div class="footer-col">
                <h3>Support</h3>
                <ul class="footer-links">
                    <li><a href="#">Centre d'aide</a></li>
                    <li><a href="#">Conditions d'utilisation</a></li>
                    <li><a href="#">Politique de confidentialit√©</a></li>
                    <li><a href="#">Signaler un probl√®me</a></li>
                </ul>
            </div>
        </div>

        <!-- Bas de page -->
        <div class="footer-bottom">
            <p>&copy; 2025 EM AREA - Fait avec ‚ù§Ô∏è √† Lom√©, Togo.</p>
        </div>
    </div>
</footer>

    <!-- MENU DU BAS (3 √âl√©ments, sans Market) -->
    <nav class="bottom-nav">
        <a href="index.html" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>
            Accueil
        </a>
        <a href="jobs.html" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>
            Jobs
        </a>
        <a href="map.html" class="nav-item active">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="10" r="3"/><path d="M12 21.7C17.3 17 20 13 20 10a8 8 0 1 0-16 0c0 3 2.7 7 8 11.7z"/></svg>
            Carte
        </a>
    </nav>

    <div class="theme-toggle" onclick="toggleDarkMode()">üåì</div>
    
  <!-- MODALE D'ALERTE PERSONNALIS√âE -->
<div id="custom-alert" class="modal-overlay" style="z-index: 4000;">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="alert-title">Notification</h3>
            <button class="close-btn" onclick="closeAlert()">&times;</button>
        </div>
        <!-- Le message s'affichera ici -->
        <div id="alert-message" style="font-size:0.9rem; line-height:1.6; color:#666; margin-bottom:20px;"></div>
        
        <button class="btn btn-primary" onclick="closeAlert()" style="width:100%;">C'est compris</button>
    </div>
</div>
    <!-- SCRIPTS -->
    <script src="js/app.js"></script>
    <script src="js/map.js"></script>
    <!-- SCRIPT PWA & ALERTES -->
<script>
    // 1. GESTION ALERTE MODALE
    function showCustomAlert(title, message) {
        const modal = document.getElementById('custom-alert');
        const titleEl = document.getElementById('alert-title');
        const msgEl = document.getElementById('alert-message');
        
        if(modal && titleEl && msgEl) {
            titleEl.textContent = title;
            msgEl.innerHTML = message.replace(/\n/g, '<br>');
            modal.classList.add('active');
        } else {
            alert(message); // S√©curit√©
        }
    }

    function closeAlert() {
        const modal = document.getElementById('custom-alert');
        if(modal) modal.classList.remove('active');
    }
    
    window.addEventListener('click', (e) => {
        const modal = document.getElementById('custom-alert');
        if (e.target === modal) closeAlert();
    });

    // 2. LOGIQUE PWA
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
    });

    async function installPWA() {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            deferredPrompt = null;
        } else {
            const isIos = /iPhone|iPad|iPod/.test(navigator.userAgent);
            if (isIos) {
                showCustomAlert("üçé Installation iPhone", "1. Appuyez sur 'Partager' (carr√© avec fl√®che).\n2. Cherchez 'Sur l'√©cran d'accueil'.\n3. Cliquez sur 'Ajouter'.");
            } else {
                showCustomAlert("‚ö†Ô∏è Information", "L'application est probablement d√©j√† install√©e ou votre navigateur ne le permet pas directement.");
            }
        }
    }
</script>
</body>
</html>
